!function(a){"use strict";function b(a,b){throw{name:a,message:b,toString:function(){return this.name+": "+this.message}}}function c(a){b("NotImplementedError","You must implement "+a+" in order to continue you idiot.")}function d(a,b){this.context=a,this.implement=b}var e,f={},g=Backbone.View,h={};e={compile:function(a,c){return a?(c=c||{},JST[a](c)):(b("NoTemplateNameSpecified","Ok, don't be a douche, provide a template name you dummy."),void 0)}},f.Config=function(a){h=_.extend({},e,a)},f.Inject=function(a){function c(a){var b={};return"function"==typeof a?b=new a:a.name&&"function"==typeof a.name&&(b=new a.name(a.args||{})),b}a=a||{};var d={model:function(a){return a instanceof Backbone.Model?a:c(a)},collection:function(a){return a instanceof Backbone.Collection?a:c(a)},subView:function(a){return c(a)},subViews:function(a){var b={};return _.each(a,function(a,d){b[d]=c(a)}),b}};return a.name?(a.args=a.args||{},_.each(a.args,function(b,c){c&&d[c]&&(a.args[c]=d[c](b))}),new a.name(a.args||{})):(b("ObjectNotFound","Come on you idiot, pass in a qualified object."),void 0)},f.Bundler=Backbone.View.extend({initialize:function(a){this.views=[],this.length=0,this.currentView={},this.parentEl=this.el,this.on("bundler:add",this.addToBundler,this),this.appendViews(a.views)},render:function(a){return this.setCurrentView(a),this.parentEl.appendChild(this.renderCurrentView().el),this.currentView.trigger("yahweh:foundation:post-render"),this},renderCurrentView:function(){return this.currentView.el=this.currentView.render().el,this.currentView},tearDownCurrentView:function(){_.isEmpty(this.currentView)||(this.currentView.trigger("teardown"),this.currentView.teardown&&this.currentView.teardown())},appendViews:function(a){for(var b=0,c=a.length;c>b;b++)this.createView(a[b])},addView:function(a){return this.createView(a),this},addToBundler:function(){this.length++},setCurrentView:function(a){return a&&(this.currentView=a),this},createView:function(a){var b=f.Inject(a);b.parentEl=this.parentEl,this.trigger("bundler:add",b),this.views.push(b)}}),f.Builder=Backbone.View.extend({initialize:function(a){this.preInit(a),this.sections=this.createSections(a.sections||{}),this.postInit(a)},createSections:function(a){var b={};return _.each(a,function(a,c){b[c]=this.createInstance(c,a)},this),b},createInstance:function(a,b){return b.args=b.args||{},this.setupDefaultArgs(a,b.args),b.args=this.addToInstantiation(b.args),new f.Inject(b)},setupDefaultArgs:function(a,b){b.parentEl=this.el},addToInstantiation:function(a){return a},render:function(){return this.preRender(),_.each(this.sections,function(a,b){this.appendSection(b,a)},this),this.postRender(),this},appendSection:function(a,c){var d;(d=document.getElementById(a))?d.appendChild(c.render().el):b("NodeNotFound","Hey dummy! If you're going to define an id, use it, ok?")},preInit:function(){},postInit:function(){},preRender:function(){},postRender:function(){}}),d.prototype.implementMethods=function(){return this.checkImplementation("properties",this.checkProperty),this},d.prototype.implementProperties=function(){return this.checkImplementation("methods",this.checkMethod),this},d.prototype.checkImplementation=function(a,b){var c=this.context.implement[a];if(c)for(var d=0,e=c.length;e>d;d++)b.call(this,c[d])},d.prototype.checkProperty=function(a){this.context[a]||c(a)},d.prototype.checkMethod=function(a){this.context[property]||(this.context[a]=function(){c(a)})},f.Implementer=d,f.Foundation=Backbone.View.extend({load:{},data:{},cache:!1,loaded:!1,add:function(a,b){return a&&(this.data[a]=b),this},get:function(a){return this.data[a]},template:function(){c("template")},cached:{},context:function(a){return a||{}},render:function(){return this.setDefaultData(),this.handleRendering(),this},handleRendering:function(){return!_.isEmpty(this.load)&&this.load.obj?this.renderLoad():this.renderTemplate(),this},getLoadKey:function(){return this.load&&this.load.key},getResponseKey:function(){var a,b=this.getTemplate(),c=this.getLoadKey();return this.cache&&(c?a=c:b&&(a=b)),a},getCachedResponse:function(){if(this.cache){var a=this.getResponseKey(),b=this.getFromCache(a);return b}},renderLoad:function(){var a;(a=this.getCachedResponse())?this.renderTemplate(a):this.retrieve()},retrieve:function(){var a=_.bind(this.load.obj,this);a().fetch({data:this.load.data||{},success:_.bind(this.success,this)})},getTemplate:function(){return this.resolveType("template")},success:function(a,b){this.renderTemplate(b)},renderTemplate:function(a){var b,c,d,e="";c=this.context(a),d=_.extend({},c,this.data),b=this.getTemplate(),b&&(e=h.compile(b,d)),this.cache&&this.sendToCache(this.getResponseKey(),a),this.checkLoaded(),this.dumpHTML(e),this.trigger("post-render")},dumpHTML:function(a){this.$el.html(a)},getFromCache:function(a){return this.cached[a]},sendToCache:function(a,b){this.cached[a]=b},resolveType:function(a){var b,c=this[a],d=typeof c;return c&&(b="function"===d?c.call(this):c),b},nestCollectionWithSubView:function(a,b,c){this.on("post-render",function(){var d=f.collector({el:"#"+a,subView:b,collection:this.collection,parent:this,args:c});this.on("teardown",function(){d.trigger("teardown")})})},setDefaultData:function(){this.add("loaded",this.loaded)},checkLoaded:function(){this.on("post-render",function(){this.loaded||(this.loaded=!0)})}}),f.Collector=Backbone.View.extend({initialize:function(a){this.subView=a.subView,this.parent=a.parent,this.args=a.args},render:function(){return this.renderSubViews(function(a){return this.collection.each(function(b,c){this.appendSubView(a,b,c)},this),a}),this},renderRange:function(a,b){return this.renderSubViews(function(c){for(var d;b>a;)d=this.collection.at(a),d&&this.appendSubView(c,d,a),a++}),this},appendSubView:function(a,b,c){var d=this.createSubView(b,c);this.on("teardown",function(){d.trigger("teardown"),d.remove()}),a.appendChild(d.render().el)},renderSubViews:function(a){var b=document.createDocumentFragment();a.call(this,b),this.appendToEl(b)},appendToEl:function(a){this.el.appendChild(a)},appendViewFragment:function(a,b){a.appendChild(b.render().el)},createSubView:function(a,b){var c={model:a,index:b,parent:this.parent};return this.callSubView(_.extend(c,this.args))},callSubView:function(a){var b;return b=this.subView.prototype?new this.subView(a):this.subView(a)}}),f.collector=function(a){var b,c={render:!0};return _.defaults(a,c),b=new f.Collector(a),a.render&&(b=b.render()),b},function(){Backbone.View=g.extend({constructor:function(){g.apply(this,Array.prototype.slice.call(arguments)),this.implementations()},implementations:function(){this.implement&&new d(this,this.implement).implementMethods().implementProperties()}}),_.isEmpty(h)&&(h=e)}(),a.Yahweh=f}(window);