!function(a){function b(a){return a?(1!==a.indexOf("!")&&(a="!"+a),a+"/"):void 0}function c(a){var c,f,g=b(a.root,a.hashbang)||"";return a.root=g,c=new d(a).render(),f=new e({view:c,root:a.root,hashbang:a.hashbang}),a.start&&Backbone.history.start(),{view:c,router:f}}var d=Yahweh.Builder.extend({preInit:function(a){this.root=a.root,this.bundler=a.bundler,this.views=this.bundler.views,this.viewsObj=this.createViewsObj()},postInit:function(){this.on("path-change",this.renderSection,this)},addToInstantiation:function(a){return a.root=this.root,a.bundler=this.bundler,a.views=this.views,a.builder=this,a},createViewsObj:function(){var a,b,c,d={};for(a=0,b=this.views.length;b>a;a++)c=this.views[a],d[c.path]=c;return d},renderSection:function(a){var b;this.bundler.tearDownCurrentView(),a?b=this.viewsObj[a]:(b=this.views[0],a=this.views[0].path),this.bundler.setCurrentView(b),this.bundler.render()}}),e=Backbone.Router.extend({initialize:function(a){this.counter=0,this.root=a.root||"",this.view=a.view,this.hashbang=a.hashbang,this.setPageRoute()},routes:{"":"listenForPath"},setPageRoute:function(){var a="listenForPath";this.route(this.root+":path",a),this.hashbang&&this.route(this.root.substring(1)+":path",a)},listenForPath:function(a){this.view.trigger("path-change",a,this.counter++)}});a.PageManager=c}(window);